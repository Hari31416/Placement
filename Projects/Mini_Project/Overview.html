<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Mini Project</title>
    <style>
        /* From extension vscode.github */
        /*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

        .vscode-dark img[src$=\#gh-light-mode-only],
        .vscode-light img[src$=\#gh-dark-mode-only] {
            display: none;
        }

        /* From extension ms-toolsai.jupyter */
        /* These classnames are inherited from bootstrap, but are present in most notebook renderers */

        .alert {
            width: auto;
            padding: 1em;
            margin-top: 1em;
            margin-bottom: 1em;
        }

        .alert>*:last-child {
            margin-bottom: 0;
        }

        #preview>.alert:last-child {
            /* Prevent this being set to zero by the default notebook stylesheet */
            padding-bottom: 1em;
        }

        .alert-success {
            /* Note there is no suitable color available, so we just copy "info" */
            background-color: var(--theme-info-background);
            color: var(--theme-info-foreground);
        }

        .alert-info {
            background-color: var(--theme-info-background);
            color: var(--theme-info-foreground);
        }

        .alert-warning {
            background-color: var(--theme-warning-background);
            color: var(--theme-warning-foreground);
        }

        .alert-danger {
            background-color: var(--theme-error-background);
            color: var(--theme-error-foreground);
        }
    </style>

    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
    <style>
        .task-list-item {
            list-style-type: none;
        }

        .task-list-item-checkbox {
            margin-left: -20px;
            vertical-align: middle;
            pointer-events: none;
        }
    </style>

</head>

<body class="vscode-body vscode-light">
    <h1 id="1-mini-project">1. Mini Project</h1>
    <ul>
        <li><a href="#1-mini-project">1. Mini Project</a>
            <ul>
                <li><a href="#11-data-source">1.1. Data Source</a></li>
                <li><a href="#12-aim">1.2. Aim</a></li>
                <li><a href="#13-methodology">1.3. Methodology</a>
                    <ul>
                        <li><a href="#131-using-opencv">1.3.1. Using OpenCV</a></li>
                        <li><a href="#132-preprocessing">1.3.2. Preprocessing</a></li>
                    </ul>
                </li>
                <li><a href="#14-the-main-algorithm">1.4. The Main Algorithm</a>
                    <ul>
                        <li><a href="#141-problems-with-the-main-algorithm">1.4.1. Problems With The Main Algorithm</a>
                        </li>
                        <li><a href="#142-dynamic-cropping">1.4.2. Dynamic Cropping</a></li>
                        <li><a href="#143-subtracting-images">1.4.3. Subtracting Images</a></li>
                    </ul>
                </li>
                <li><a href="#15-the-second-algorithm-all-points-method">1.5. The Second Algorithm: All Points
                        Method</a>
                    <ul>
                        <li><a href="#151-why-another-algorithm">1.5.1. Why Another Algorithm?</a></li>
                        <li><a href="#152-extracting-all-points">1.5.2. Extracting All Points</a></li>
                        <li><a href="#153-fitting-an-ellipse">1.5.3. Fitting An Ellipse</a></li>
                    </ul>
                </li>
                <li><a href="#16-the-final-algorithm">1.6. The Final Algorithm</a></li>
                <li><a href="#17-results">1.7. Results</a></li>
                <li><a href="#18-question-section">1.8. Question Section</a>
                    <ul>
                        <li><a href="#181-what-were-the-most-challenging-aspect-of-the-project-and-how-you-overtook-it">1.8.1.
                                What were the most challenging aspect of the project and how you overtook it?</a></li>
                        <li><a href="#182-what-improvements-can-be-made">1.8.2. What improvements can be made?</a></li>
                        <li><a href="#183-why-did-this-algorithm-work-or-didnt-work">1.8.3. Why did this algorithm work
                                or didn't work?</a></li>
                        <li><a href="#184-if-you-were-to-do-something-differently-what-would-that-be">1.8.4. If you were
                                to do something differently, what would that be?</a></li>
                        <li><a href="#185-some-mistakes-you-made">1.8.5. Some mistakes you made</a></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    <h2 id="11-data-source">1.1. Data Source</h2>
    <p>The data was given to us by the professor. It was generated by previous year's Ph.D. students. They performed
        variuos experiments where they dropped the drop of water from various heights and also the angle of the thin
        film was also choses differently.</p>
    <p>There are a number of videos each having frames ranging 50-200. Videos are typically of two types, one where the
        height is varied and other where the angle is varied.</p>
    <h2 id="12-aim">1.2. Aim</h2>
    <p>Our goal was to write an algorithms which can extract the coordinates and radii of the center of the drop. Once
        we get these information, further studies can be performed on the data.</p>
    <h2 id="13-methodology">1.3. Methodology</h2>
    <p>We implemented a number of algorithms for this. These algorithms were implemented from scratch in Pyhton and
        numpy.</p>
    <h3 id="131-using-opencv">1.3.1. Using OpenCV</h3>
    <p>We tried using OpenCV, specifically the <code>HoughCircles</code> function. This function takes in the image and
        the parameters and returns the coordinates and radii of the circles. We tried using this function on the images
        and videos. The circles were not detected properly. We tried changing the parameters but the results were not
        satisfactory.</p>
    <h3 id="132-preprocessing">1.3.2. Preprocessing</h3>
    <p>There were a number of steps involved before we can feed the image to the algorithm. These steps were:</p>
    <ol>
        <li><strong>Cropping:</strong> The region of interest was just a small frcation of the image, so, the image was
            cropped to the region of interest.</li>
        <li>The image was already grayscale, so, we did not have to convert it to grayscale.</li>
        <li><strong>Subtracting From Base Image:</strong> This was done to remove the background noise.</li>
        <li><strong>Thresholding:</strong> The image was thresholded to get a binary image. This was done to remove the
            noise from the image.</li>
    </ol>
    <h2 id="14-the-main-algorithm">1.4. The Main Algorithm</h2>
    <p>The main idea behind the algorithm was to use the contrast between the background and the circumference of the
        drop to detect its center. The main algorithm is:</p>
    <ol>
        <li>Loop through the rows and find the first and last pixel which is not black.</li>
        <li>Repeat the same for the columns.</li>
        <li>Use these four points to find the center of the drop and the radii.</li>
    </ol>
    <h3 id="141-problems-with-the-main-algorithm">1.4.1. Problems With The Main Algorithm</h3>
    <p>The main algorithm was unsuccessful while detecting the drop when it was near the needle or the thin film. Also,
        we needed to give the crop coordinates (<code>(x,y,h,w)</code>) of each the points for it to work. This was not
        a good solution. Solution to the second problem was by using dynammic cropping.</p>
    <h3 id="142-dynamic-cropping">1.4.2. Dynamic Cropping</h3>
    <p>Here, the crop coordinates were calculated dynamically. The algorithm was:</p>
    <ol>
        <li>Initialize by first giving the crop coordinates.</li>
        <li>The algorithm determines the center of the drop and the radii.</li>
        <li>Use this value of the center to calculate the new crop coordinates.</li>
        <li>Reapeat the process.</li>
    </ol>
    <p>Even dynamic programming was not able to solve all the problem. First, we still needed to give the first crop
        coordinates. Second, the algorithm was still not able to detect the drop when it was near the thin film. So
        basically, we needed to run the algorithm on three different regions of the image, providing the crop
        coordinates for each of them.</p>
    <h3 id="143-subtracting-images">1.4.3. Subtracting Images</h3>
    <p>The next idea was to subtract the background from the image and then use the main algorithm. For this, an image
        with no drop was taken and subtracted from the image with the drop. This resulted in a image which had just the
        drop with some light noise which can then be removed by thresholding. Using the main algorithm with dynamic
        cropping and subtracting the images, we were able to detect the drop in almost all the cases.</p>
    <h2 id="15-the-second-algorithm-all-points-method">1.5. The Second Algorithm: All Points Method</h2>
    <h3 id="151-why-another-algorithm">1.5.1. Why Another Algorithm?</h3>
    <p>The main algorithm, though working correctly, had some limitations. First, it was missing a lot of frames when
        the drop was near the thin film. Secondly, watching the videos, we observed that the drop was oscillating and we
        wanted to detect these oscillations. For this things, we needed another algorithm.</p>
    <h3 id="152-extracting-all-points">1.5.2. Extracting All Points</h3>
    <p>The first step was to extract all the points on the circumference of the drop. This was done again, by looping
        through rows and columns and adding each white pixel to a list.</p>
    <h3 id="153-fitting-an-ellipse">1.5.3. Fitting An Ellipse</h3>
    <p>The next step was to fit an ellipse to the points. This was done using the
        <code>skimage.measure.fit_ellipse</code> function. This function takes in the points and returns the center, the
        major and minor axis and the angle of rotation.
    </p>
    <h2 id="16-the-final-algorithm">1.6. The Final Algorithm</h2>
    <p>This was a combination of the second algorithm with dynamic cropping and subtracting the images. We also tried
        using the algorithm on grayscale images however the result was not good. So, we used the algorithm on the binary
        images.</p>
    <h2 id="17-results">1.7. Results</h2>
    <p>The coordinates of center and the radii, as well as the angle of rotation for over 40 videos (spanning over 5000
        frames) were extracted. The results were stored in a csv file. The csv file was then used to do some rudimentary
        analysis.</p>
    <h2 id="18-question-section">1.8. Question Section</h2>
    <h3 id="181-what-were-the-most-challenging-aspect-of-the-project-and-how-you-overtook-it">1.8.1. What were the most
        challenging aspect of the project and how you overtook it?</h3>
    <p>It was to generalize the algorithm we created. Even after cropping, the algorithm was not robust in a sense that
        we needed to give coordinates for crop of each frame. Also, if the drop was near the needle and the thin film,
        the algorith was not working. This problem was partially solved by using the dynamic cropping and by subtracting
        images.</p>
    <h3 id="182-what-improvements-can-be-made">1.8.2. What improvements can be made?</h3>
    <p>The algorithm still is not detecting drops all the time. When the drop is near the thin film, it fails. Also, for
        some frames, the coordinates extracted by the drop is not at the position of the drop. We can improve our
        algorithm to take into account these problems.</p>
    <h3 id="183-why-did-this-algorithm-work-or-didnt-work">1.8.3. Why did this algorithm work or didn't work?</h3>
    <p>The algorithm assumes that there are not white points other than that formed by the circumference of the drop. If
        it finds some white point at places other than this, it will think that it is at the circumference of the drop
        and give wrong result.</p>
    <h3 id="184-if-you-were-to-do-something-differently-what-would-that-be">1.8.4. If you were to do something
        differently, what would that be?</h3>
    <p>I might try to write an algorithm which determines whether a point is on the circumference of the circle by not
        only looping through the rows and columns but also by keeping track of where the previous points are and whether
        they are related to each other in a way which forms a &quot;circle&quot;?</p>
    <h3 id="185-some-mistakes-you-made">1.8.5. Some mistakes you made</h3>



</body>

</html>